{% extends "base.html" %}
{% block content %}

<div class="container mt-5 mb-5">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
        <div>
            <h2 class="fw-bold text-primary mb-1">RTI Details</h2>
            <small class="text-muted">
                Department of Rural Development & Panchayat Raj
            </small>
        </div>
        <a href="/" class="btn btn-outline-secondary">
            ‚Üê Back
        </a>
    </div>

    <!-- Basic Information -->
    <div class="card shadow-lg border-0 mb-4">
    <div class="card-header bg-primary text-white fw-semibold">
        Basic Information
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th scope="col" style="width: 30%;">Field</th>
                        <th scope="col">Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="text-muted">Reference Number</td>
                        <td class="fw-semibold fs-5">{{ rti.reference_number }}</td>
                    </tr>
                    <tr>
                        <td class="text-muted">Applicant Name</td>
                        <td class="fw-semibold">{{ rti.applicant_name }}</td>
                    </tr>
                    <tr>
                        <td class="text-muted">Date Filed</td>
                        <td>{{ rti.date_filed|date:"d M Y" }}</td>
                    </tr>
                    <tr>
                        <td class="text-muted">Subject</td>
                        <td>
                            <div class="p-2 bg-light rounded border">
                                {{ rti.subject }}
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-muted">Panchayat</td>
                        <td class="fw-semibold text-primary">{{ rti.panchayat.name }}</td>
                    </tr>
                    <tr>
                        <td class="text-muted">Status</td>
                        <td>
                            <span class="badge bg-{{ rti.status_color|default:'secondary' }} px-3 py-2">
                                {{ rti.status }}
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>



    <!-- Response Section -->
    <div class="card shadow-lg border-0 mb-4">
    <div class="card-header bg-success text-white fw-semibold">
        Response Information
    </div>

        <div class="card-body">

            {% if response %}

                <p><strong>Reply:</strong></p>
                <div class="border rounded p-3 bg-light mb-3">
                    {{ response.reply_text }}
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-semibold">Date Replied:</div>
                    <div class="col-md-8">{{ response.date_replied }}</div>
                </div>

                <div class="row">
                    <div class="col-md-4 fw-semibold">Delayed:</div>
                    <div class="col-md-8">
                        {% if response.is_delayed %}
                            <span class="badge bg-danger">Yes</span>
                        {% else %}
                            <span class="badge bg-success">No</span>
                        {% endif %}
                    </div>
                </div>

            {% else %}
                <div class="alert alert-warning border-0 shadow-sm mb-0">
                    ‚è≥ No response submitted yet.
                </div>
            {% endif %}

        </div>
    </div>

    <!-- Analyst Review -->
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light fw-semibold">
            Analyst Review
        </div>
        <div class="card-body">

            {% if review %}

                <div class="row mb-3">
                    <div class="col-md-4 fw-semibold">Review Status:</div>
                    <div class="col-md-8">

                        {% if review.status == "COMPLETE" %}
                            <span class="badge bg-success">Complete</span>
                        {% elif review.status == "VAGUE" %}
                            <span class="badge bg-warning text-dark">Vague</span>
                        {% elif review.status == "DENIED" %}
                            <span class="badge bg-dark">Denied</span>
                        {% elif review.status == "DELAYED" %}
                            <span class="badge bg-danger">Delayed</span>
                        {% else %}
                            <span class="badge bg-secondary">{{ review.status }}</span>
                        {% endif %}

                    </div>
                </div>

                <p><strong>Remarks:</strong></p>
                <div class="border rounded p-3 bg-light">
                    {{ review.remarks }}
                </div>

            {% else %}
                <div class="alert alert-info mb-0">
                    No analyst review available yet.
                </div>
            {% endif %}

        </div>
    </div>
    <!-- Documents Section -->
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light fw-semibold">
            RTI Documents
        </div>
        <div class="card-body">

            {% if rti.original_application %}
                <a href="{{ rti.original_application.url }}"
                class="btn btn-outline-primary me-2 mb-2"
                target="_blank">
                    üìÑ Download Original RTI
                </a>
            {% endif %}

            {% if rti.acknowledgement_document %}
                <a href="{{ rti.acknowledgement_document.url }}"
                class="btn btn-outline-warning me-2 mb-2"
                target="_blank">
                    üì© Download Acknowledgement
                </a>
            {% endif %}

            {% if rti.response_document %}
                <a href="{{ rti.response_document.url }}"
                class="btn btn-outline-success me-2 mb-2"
                target="_blank">
                    üìÑ Download Response
                </a>
            {% endif %}

            {% if not rti.original_application and not rti.acknowledgement_document and not rti.response_document %}
                <div class="alert alert-secondary mb-0">
                    No documents uploaded yet.
                </div>
            {% endif %}

        </div>
    </div>
</div>

{% endblock %}
